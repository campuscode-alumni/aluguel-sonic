scenario 'and sees unavailable periods of the property' do
  property = Property.create(title:'Casa na praia', property_location:'SÃ£o Vicente - SP',
                              area:'100', description:'Lalala', daily_rate:100,
                              rooms:2, minimum_rent_days:5,
                              maximum_rent_days:10, photo:'/mi.jpg',
                              maximum_occupancy:20, usage_rules:'no dogs',
                              property_type:'Casa da praia')

  period_unavailable = UnavailablePeriod.create(start_date_unavailable: '20/12/2017',
                                                end_date_unavailable: '28/12/2017',
                                                property: property)

  visit root_path

  expect(page).to have_css('dt', text: 'Datas indisponiveis:')
  expect(page).to have_css('dd', text: "De #{I18n.localize property.unavailable_period.start_date_unavailable}
                                        Ate #{I18n.localize property.unavailable_period.end_date_unavailable}")
end


scenario 'and accepted other proposal in same period but its rejected' do
  property = Property.create(property_location: 'Rio de Janeiro',
                             area: '100m2', title: 'Casa na praia',
                             description: 'Casa na praia em copacabana',
                             daily_rate: 200, rooms: 5,
                             minimum_rent_days: 2, maximum_rent_days: 5,
                             photo: 'casa.png', maximum_occupancy: 5,
                             usage_rules: 'sem animais',
                             property_type: 'praia')

  proposal1 = Proposal.create(user_name: 'Nailson_Ita',
                              email: 'nailson.ita@ita.com',
                              start_date: '16/10/2017',
                              end_date: '19/10/2017',
                              rent_purpose: 'Casamento',
                              agree_with_rules: true,
                              total_amount: 600,
                              total_guests: 5,
                              status: 1,
                              property: property)

  proposal2 = Proposal.create(user_name: 'Nailson_Ita',
                              email: 'nailson.ita@ita.com',
                              start_date: '16/10/2017',
                              end_date: '19/10/2017',
                              rent_purpose: 'Casamento',
                              agree_with_rules: true,
                              total_amount: 600,
                              total_guests: 5,
                              status: 0,
                              property: property)

  visit proposal_path(proposal2)
  click_on 'Aceitar proposta'
  proposal1.reload
  proposal2.reload

  expect(proposal1.accepted?).to eq true
  expect(proposal2.rejected?).to eq true
end
